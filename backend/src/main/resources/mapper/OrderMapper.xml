<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.logistics.mapper.OrderMapper">

    <resultMap id="BaseResultMap" type="com.logistics.entity.Order">
        <id column="id" property="id" jdbcType="BIGINT"/>
        <result column="order_no" property="orderNo" jdbcType="VARCHAR"/>
        <result column="customer_name" property="customerName" jdbcType="VARCHAR"/>
        <result column="order_amount" property="orderAmount" jdbcType="DECIMAL"/>
        <result column="order_date" property="orderDate" jdbcType="TIMESTAMP"/>
        <result column="status" property="status" jdbcType="VARCHAR"/>
        <result column="created_time" property="createdTime" jdbcType="TIMESTAMP"/>
        <result column="updated_time" property="updatedTime" jdbcType="TIMESTAMP"/>
    </resultMap>

    <select id="selectOrderStatistics" resultType="java.util.Map">
        SELECT 
            COUNT(*) as totalCount,
            SUM(order_amount) as totalAmount,
            AVG(order_amount) as avgAmount,
            MAX(order_amount) as maxAmount,
            MIN(order_amount) as minAmount,
            COUNT(DISTINCT customer_name) as customerCount
        FROM orders
    </select>

    <select id="selectOrdersByStatusGroup" resultType="java.util.Map">
        SELECT 
            status,
            COUNT(*) as count,
            SUM(order_amount) as totalAmount
        FROM orders
        GROUP BY status
        ORDER BY totalAmount DESC
    </select>

    <select id="selectOrdersByDateRange" resultType="java.util.Map">
        SELECT 
            id,
            order_no,
            customer_name,
            order_amount,
            order_date,
            status
        FROM orders
        WHERE order_date BETWEEN #{startDate} AND #{endDate}
        ORDER BY order_date DESC
    </select>

    <select id="selectOrdersByCustomerName" resultMap="BaseResultMap">
        SELECT * FROM orders
        WHERE customer_name LIKE CONCAT('%', #{customerName}, '%')
        ORDER BY order_date DESC
    </select>

</mapper>