# Docker MCP 环境配置参考

## 系统环境

- **操作系统**: Windows 11 Home Edition
- **虚拟化**: WSL2
- **Docker**: Docker Desktop (WSL2 后端)
- **Python**: TraeAI-7 虚拟环境

## 配置文件

### Trae MCP 配置
**路径**: `C:\Users\15071\AppData\Roaming\Trae CN\User\mcp.json`

```json
"docker": {
    "command": "python",
    "args": [
        "c:\\Users\\15071\\Desktop\\测试\\trae_docker_mcp.py"
    ],
    "env": {},
    "fromGalleryId": "byted-mcp-volcengine.3rd_party_mcp_server_docker"
}
```

## 关键文件

| 文件 | 路径 | 说明 |
|-----|------|------|
| MCP 服务器 | `c:\Users\15071\Desktop\测试\trae_docker_mcp.py` | 主脚本 |
| 测试脚本 | `c:\Users\15071\Desktop\测试\test_mcp_client.py` | 基本测试 |

## 可用的 Docker 工具

### 容器 (8个)
```
list_containers, create_container, run_container, recreate_container,
start_container, fetch_container_logs, stop_container, remove_container
```

### 镜像 (5个)
```
list_images, pull_image, push_image, build_image, remove_image
```

### 网络 (3个)
```
list_networks, create_network, remove_network
```

### 卷 (3个)
```
list_volumes, create_volume, remove_volume
```

## 快速使用

### 启动 MCP 服务器
```bash
cd "c:\Users\15071\Desktop\测试"
python trae_docker_mcp.py
```

### 测试连接
```bash
python test_mcp_client.py
```

### 在 Trae 中使用
直接在 Trae 中调用 Docker MCP 工具即可。

## 技术说明

### 为什么使用自定义脚本？
- 系统没有安装 `uvx` 命令
- 官方包可能有依赖问题
- 自定义脚本提供更好的控制和兼容性

### Mock Docker 客户端
- 当真实 Docker 连接失败时自动切换
- 提供模拟数据用于测试
- 不影响真实 Docker 操作

### 假 Windows 模块
- 绕过缺失的 Windows 依赖（pywintypes, pythoncom, win32file 等）
- 不影响 MCP 功能
- 确保 Windows 系统兼容性

## 常见问题

### MCP 服务器启动后没有响应？
正常！MCP 服务器会等待来自 Trae 的 JSON-RPC 消息。

### 如何切换到真实 Docker？
脚本会自动尝试连接真实 Docker。确保 Docker Desktop 正在运行。

### 如何重启 MCP 服务器？
停止当前进程，重新运行 `python trae_docker_mcp.py`，或重启 Trae 应用。

## 状态

- ✅ WSL2: 已安装
- ✅ Ubuntu: 已安装
- ✅ Docker Desktop: 已安装并运行
- ✅ MCP Docker Server: 已配置并测试

---

**最后更新**: 2025-12-27
